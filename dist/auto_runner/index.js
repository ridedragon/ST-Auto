import{createPinia as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var t={42:(e,t)=>{t.A=(e,t)=>{const r=e.__vccOpts||e;for(const[e,n]of t)r[e]=n;return r}},54:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r='',n=void 0!==t[5];return t[4]&&(r+='@supports ('.concat(t[4],') {')),t[2]&&(r+='@media '.concat(t[2],' {')),n&&(r+='@layer'.concat(t[5].length>0?' '.concat(t[5]):'',' {')),r+=e(t),n&&(r+='}'),t[2]&&(r+='}'),t[4]&&(r+='}'),r}).join('')},t.i=function(e,r,n,a,o){'string'==typeof e&&(e=[[null,e,void 0]]);var l={};if(n)for(var i=0;i<this.length;i++){var s=this[i][0];null!=s&&(l[s]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);n&&l[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]='@layer'.concat(u[5].length>0?' '.concat(u[5]):'',' {').concat(u[1],'}')),u[5]=o),r&&(u[2]?(u[1]='@media '.concat(u[2],' {').concat(u[1],'}'),u[2]=r):u[2]=r),a&&(u[4]?(u[1]='@supports ('.concat(u[4],') {').concat(u[1],'}'),u[4]=a):u[4]=''.concat(a)),t.push(u))}},t}},93:e=>{e.exports=function(e){return e[1]}},140:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(93),a=r.n(n),o=r(54),l=r.n(o)()(a());l.push([e.id,'.wide-button[data-v-1f19aa45]{width:100%}label[data-v-1f19aa45]{margin-top:10px;margin-bottom:5px;font-size:.9em;color:#ccc}hr[data-v-1f19aa45]{border:none;border-top:1px solid var(--bg2);margin:15px 0}input[type=range][data-v-1f19aa45]{width:100%}','']);const i=l},424:(e,t,r)=>{function n(e,t){for(var r=[],n={},a=0;a<t.length;a++){var o=t[a],l=o[0],i={id:e+':'+a,css:o[1],media:o[2],sourceMap:o[3]};n[l]?n[l].parts.push(i):r.push(n[l]={id:l,parts:[i]})}return r}r.d(t,{A:()=>v});var a='undefined'!=typeof document;if('undefined'!=typeof DEBUG&&DEBUG&&!a)throw new Error('vue-style-loader cannot be used in a non-browser environment. Use { target: \'node\' } in your Webpack config to indicate a server-rendering environment.');var o={},l=a&&(document.head||document.getElementsByTagName('head')[0]),i=null,s=0,c=!1,u=function(){},d=null,p='data-vue-ssr-id',m='undefined'!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function v(e,t,r,a){c=r,d=a||{};var l=n(e,t);return f(l),function(t){for(var r=[],a=0;a<l.length;a++){var i=l[a];(s=o[i.id]).refs--,r.push(s)}t?f(l=n(e,t)):l=[];for(a=0;a<r.length;a++){var s;if(0===(s=r[a]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}}function f(e){for(var t=0;t<e.length;t++){var r=e[t],n=o[r.id];if(n){n.refs++;for(var a=0;a<n.parts.length;a++)n.parts[a](r.parts[a]);for(;a<r.parts.length;a++)n.parts.push(x(r.parts[a]));n.parts.length>r.parts.length&&(n.parts.length=r.parts.length)}else{var l=[];for(a=0;a<r.parts.length;a++)l.push(x(r.parts[a]));o[r.id]={id:r.id,refs:1,parts:l}}}}function g(){var e=document.createElement('style');return e.type='text/css',l.appendChild(e),e}function x(e){var t,r,n=document.querySelector('style['+p+'~="'+e.id+'"]');if(n){if(c)return u;n.parentNode.removeChild(n)}if(m){var a=s++;n=i||(i=g()),t=E.bind(null,n,a,!1),r=E.bind(null,n,a,!0)}else n=g(),t=N.bind(null,n),r=function(){n.parentNode.removeChild(n)};return t(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap)return;t(e=n)}else r()}}var h,w=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join('\n')});function E(e,t,r,n){var a=r?'':n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,a);else{var o=document.createTextNode(a),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(o,l[t]):e.appendChild(o)}}function N(e,t){var r=t.css,n=t.media,a=t.sourceMap;if(n&&e.setAttribute('media',n),d.ssrId&&e.setAttribute(p,t.id),a&&(r+='\n/*# sourceURL='+a.sources[0]+' */',r+='\n/*# sourceMappingURL=data:application/json;base64,'+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+' */'),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}},642:(e,t,r)=>{var n=r(140);n.__esModule&&(n=n.default),'string'==typeof n&&(n=[[e.id,n,'']]),n.locals&&(e.exports=n.locals);(0,r(424).A)('16d3cb4e',n,!1,{ssrId:!0})}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var o=r[e]={id:e,exports:{}};return t[e](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})};const a=_;var o=n.n(a);const l=z,i=l.z.object({enabled:l.z.boolean().default(!1),prompt:l.z.preprocess(e=>e??'',l.z.string()),apiUrl:l.z.preprocess(e=>e??'',l.z.string()),apiKey:l.z.preprocess(e=>e??'',l.z.string()),model:l.z.preprocess(e=>e??'',l.z.string()),temperature:l.z.number().min(0).max(2).default(.7),top_p:l.z.number().min(0).max(1).default(1),top_k:l.z.number().min(0).default(40),max_tokens:l.z.coerce.number().min(1).default(1024),totalReplies:l.z.coerce.number().min(1).default(10),executedCount:l.z.coerce.number().min(0).default(0),regex:l.z.string().default(String.raw`<StatusPlaceHolderImpl\/>
\s*<!--[\s\S]*?-->\s*
(<disclaimer>.*?<\/disclaimer>)|(<guifan>.*?<\/guifan>)|
\`\`\`start|<content>|<\/content>|\`\`\`end|<done>|\`<done>\`|
(<!--\s*consider\s*:\s*(.*?)\s*-->)|(.*?<\/think(ing)?>(\n)?)|(<think(ing)?>[\s\S]*?<\/think(ing)?>(\n)?)
/<UpdateVariable>[\s\S]*?</UpdateVariable>/gm`),subAiRegex:l.z.preprocess(e=>e||String.raw`^.*?<\/think(ing)?>\s*`,l.z.string()),subAiRegexReplacement:l.z.preprocess(e=>e??'',l.z.string()),maxRetries:l.z.coerce.number().min(0).default(3)});var s;!function(e){e[e.IDLE=0]='IDLE',e[e.RUNNING=1]='RUNNING',e[e.PAUSED=2]='PAUSED',e[e.ERROR=3]='ERROR'}(s||(s={}));let c=s.IDLE,u=i.parse({}),d=0;const p=e=>new Promise(t=>setTimeout(t,e));async function m(){try{const e=getVariables({type:'script',script_id:getScriptId()})||{};u=i.parse(o().merge(i.parse({}),e))}catch(e){console.error('[AutoRunner] 加载设置失败:',e),toastr.error('加载设置失败，将使用默认设置。'),u=i.parse({})}}async function v(){toastr.info('正在调用副AI...');const e=await getLastMessageId(),t=getChatMessages(`0-${e}`);if(!t||0===t.length)return toastr.error('无法获取聊天记录'),null;let r=t.filter(e=>'system'!==e.role).map(e=>`${e.role}: ${e.message}`).join('\n');if(u.regex)try{const e=new RegExp(u.regex,'gm');r=r.replace(e,'')}catch(e){console.error('上下文正则表达式错误:',e),toastr.warning('上下文正则表达式无效，已跳过处理。')}const n={model:u.model,messages:[{role:'system',content:u.prompt},{role:'user',content:r}],temperature:u.temperature,top_p:u.top_p,top_k:u.top_k,max_tokens:u.max_tokens};try{const e=await fetch(`${u.apiUrl}/chat/completions`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:`Bearer ${u.apiKey}`},body:JSON.stringify(n)});if(!e.ok)throw new Error(`副AI API 请求失败: ${e.statusText}`);const t=await e.json(),r=t.choices[0]?.message?.content;if(!r)throw new Error('副AI未返回有效内容');return toastr.success('副AI响应成功'),r}catch(e){return console.error('调用副AI时出错:',e),toastr.error(`调用副AI失败: ${e.message}`),null}}async function f(){const e=window.parent.aiOptimizer;if(!e||'function'!=typeof e.manualOptimize||'function'!=typeof e.optimizeText)return toastr.warning('未找到 AI Optimizer API，跳过优化步骤。'),toastr.info('执行“一键处理”...'),await eventEmit(getButtonEvent('一键处理')),await p(4e3),!0;try{toastr.info('自动化优化流程已启动...');const t=await new Promise(t=>{e.manualOptimize(e=>t(e))});if(t){window.parent.tempPopupText=t;const r=`<p>已提取以下内容（可编辑），点击“继续”发送给AI优化：</p><textarea oninput="window.parent.tempPopupText = this.value" id="auto-optimizer-source" class="text_pole" rows="10" style="width: 100%;">${t}</textarea>`,n=await window.parent.SillyTavern.getContext().callGenericPopup(r,'步骤1: 提取并编辑','',{okButton:'继续',cancelButton:'取消',wide:!0}),a=window.parent.tempPopupText;if(delete window.parent.tempPopupText,!n)return toastr.info('自动化流程已由用户在步骤1取消。'),!1;toastr.info('正在发送给AI优化...');const o=await async function(){try{const e=await getLastMessageId();if(e<0)return'';const t=Math.max(0,e-9),r=[...getChatMessages(`${t}-${e}`)].reverse().find(e=>'assistant'===e.role);return r?r.message:''}catch(e){return console.error('获取最后一条角色消息时出错:',e),''}}(),l='function'==typeof e.getSystemPrompt?e.getSystemPrompt():'',i=await e.optimizeText(a,l,o);if(null===i)return toastr.info('优化被用户取消。'),!1;if(!i)throw new Error('AI 未能返回优化后的文本。');window.parent.tempPopupText=i;const s=`\n                  <p><b>原始句子:</b></p>\n                  <textarea class="text_pole" rows="5" style="width: 100%;" readonly>${a}</textarea>\n                  <p><b>优化后句子 (可编辑):</b></p>\n                  <textarea oninput="window.parent.tempPopupText = this.value" id="auto-optimizer-result" class="text_pole" rows="5" style="width: 100%;">${i}</textarea>\n              `,c=await window.parent.SillyTavern.getContext().callGenericPopup(s,'步骤2: 对比并确认替换','',{okButton:'替换',cancelButton:'取消',wide:!0}),u=window.parent.tempPopupText;if(delete window.parent.tempPopupText,!c)return toastr.info('替换操作已由用户取消。'),!1;toastr.info('正在执行SSC替换...'),await new Promise(t=>{e.replaceMessage(a,u,e=>{e&&toastr.success('SSC 替换完成！'),t()})})}else toastr.info('在最后一条角色消息中未找到可优化的内容，跳过SSC优化。');return await p(2e3),toastr.info('执行“一键处理”...'),await eventEmit(getButtonEvent('一键处理')),await p(4e3),!0}catch(e){return console.error('[Auto Optimizer] 流程执行出错:',e),toastr.error(e.message,'自动化优化流程失败'),!1}}async function g(){if(c!==s.RUNNING||u.executedCount>=u.totalReplies&&(toastr.info('已达到总回复次数，全自动运行结束。'),1))return void E();await m();const e=(getChatMessages(-1)||[])[0];if(!e)return toastr.error('无法获取最后一条消息，自动化暂停。'),void(c=s.PAUSED);try{if('user'===e.role)toastr.info('检测到用户消息，触发主AI生成...'),await triggerSlash('/trigger await=true');else{toastr.info('检测到AI消息，开始完整循环...');if(!await f())return toastr.warning('用户取消了操作，全自动运行已停止。'),void E();let e=null,t=0;for(;t<=u.maxRetries&&(e=await v(),!e);){if(t++,t>u.maxRetries)return toastr.error(`调用副AI已达到最大重试次数 (${u.maxRetries})，自动化已停止。`),void E();toastr.warning(`调用副AI失败，将在5秒后重试 (${t}/${u.maxRetries})`),await p(5e3)}if(!e)return toastr.error('未能从副AI获取回复，自动化已停止。'),void E();const r=function(e){if(!u.subAiRegex)return e;try{const t=new RegExp(u.subAiRegex,'g');return e.replace(t,u.subAiRegexReplacement||'')}catch(t){return console.error('副AI输出正则表达式错误:',t),toastr.warning('副AI输出正则表达式无效，已跳过处理。'),e}}(e);console.log('处理后的回复:',r),toastr.info('以用户身份发送处理后的消息...'),await triggerSlash(`/send "${r.replace(/"/g,'\\"')}"`),await triggerSlash('/trigger await=true')}await async function(){u.executedCount++,await replaceVariables(o().cloneDeep(u),{type:'script',script_id:getScriptId()})}()}catch(e){console.error('自动化循环出错:',e),toastr.error(`自动化循环发生意外错误: ${e.message}，流程已终止。`),c=s.ERROR,E()}}function x(){c===s.RUNNING&&setTimeout(g,1e3)}function h(){c===s.RUNNING&&(toastr.warning('来自系统的停止信号，全自动运行已终止。'),E())}function w(){c!==s.RUNNING&&(toastr.success('全自动运行已启动！'),c=s.RUNNING,d=0,eventOn(tavern_events.MESSAGE_RECEIVED,x),eventOn(tavern_events.GENERATION_STOPPED,h),g())}function E(){c!==s.IDLE&&(toastr.info('全自动运行已停止。'),c=s.IDLE,eventRemoveListener(tavern_events.MESSAGE_RECEIVED,x),eventRemoveListener(tavern_events.GENERATION_STOPPED,h),triggerSlash('/stop'))}function N(){E(),eventRemoveListener(getButtonEvent('全自动运行'),w)}const y=Vue,b={class:'inline-drawer'},V={class:'inline-drawer-content'},I={class:'flex-container flexFlowColumn'},S={class:'checkbox_label',for:'auto_runner_enabled'},A={class:'flex-container flexFlowColumn'},R={class:'flex-container flexFlowColumn'},T={class:'flex-container flexFlowColumn'},k={class:'flex-container flexFlowColumn'},U={class:'flex-container flexFlowColumn'},C={key:0,value:''},D=['value'],P={for:'auto_runner_temperature'},M={for:'auto_runner_top_p'},O={for:'auto_runner_top_k'},B={for:'auto_runner_max_tokens'},G={class:'flex-container flexFlowColumn'},L={id:'auto_runner_executed_count',class:'text_pole'},j=(0,y.defineComponent)({__name:'app',setup(e){const t=(0,y.ref)(i.parse({})),r=(0,y.ref)([]),n=(0,y.ref)('');(0,y.onMounted)(async()=>{try{const e=getVariables({type:'script',script_id:getScriptId()})||{},n=i.parse({}),a=o().merge(n,e);t.value=i.parse(a),t.value.model&&r.value.push(t.value.model)}catch(e){console.error('加载设置失败:',e),t.value=i.parse({})}}),(0,y.watch)(t,async e=>{try{const t=i.parse(e);await replaceVariables(o().cloneDeep(t),{type:'script',script_id:getScriptId()})}catch(e){const t=e;console.error('自动保存设置失败:',t)}},{deep:!0}),(0,y.watch)(()=>t.value.enabled,(e,r)=>{!0===e&&!1===r?(t.value.executedCount=0,eventOn(getButtonEvent('全自动运行'),()=>{c===s.RUNNING?E():w()}),m(),toastr.info('自动化脚本已启动。')):!1===e&&!0===r&&(N(),toastr.info('自动化脚本已停止。'))});const a=async()=>{if(t.value.apiUrl)try{const e=await fetch(`${t.value.apiUrl}/models`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=(await e.json()).data.map(e=>e.id);r.value=o().union(r.value,n),toastr.success('模型列表已获取')}catch(e){console.error('获取模型列表失败:',e),toastr.error('获取模型列表失败')}else toastr.error('请先填写API地址')},l=()=>{n.value?(triggerSlash(`/sendas name={{user}} ${n.value}`),toastr.success('消息已发送')):toastr.error('没有可发送的内容')};return(e,o)=>((0,y.openBlock)(),(0,y.createElementBlock)('div',b,[o[34]||(o[34]=(0,y.createElementVNode)('div',{class:'inline-drawer-toggle inline-drawer-header'},[(0,y.createElementVNode)('b',null,'自动化运行脚本设置'),(0,y.createElementVNode)('div',{class:'inline-drawer-icon fa-solid fa-circle-chevron-down down'})],-1)),(0,y.createElementVNode)('div',V,[(0,y.createElementVNode)('div',I,[(0,y.createElementVNode)('label',S,[(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_enabled','onUpdate:modelValue':o[0]||(o[0]=e=>t.value.enabled=e),type:'checkbox'},null,512),[[y.vModelCheckbox,t.value.enabled]]),o[15]||(o[15]=(0,y.createElementVNode)('span',null,'启用脚本',-1))])]),o[28]||(o[28]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',A,[o[16]||(o[16]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'提示词设置')],-1)),(0,y.withDirectives)((0,y.createElementVNode)('textarea',{'onUpdate:modelValue':o[1]||(o[1]=e=>t.value.prompt=e),class:'text_pole',placeholder:'输入给副AI的指令...'},null,512),[[y.vModelText,t.value.prompt]])]),o[29]||(o[29]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',R,[o[17]||(o[17]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'上下文正则处理')],-1)),(0,y.withDirectives)((0,y.createElementVNode)('textarea',{'onUpdate:modelValue':o[2]||(o[2]=e=>t.value.regex=e),class:'text_pole',placeholder:'输入正则表达式...'},null,512),[[y.vModelText,t.value.regex]])]),o[30]||(o[30]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',T,[o[18]||(o[18]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'副AI输出正则处理')],-1)),(0,y.withDirectives)((0,y.createElementVNode)('textarea',{'onUpdate:modelValue':o[3]||(o[3]=e=>t.value.subAiRegex=e),class:'text_pole',placeholder:'输入正则表达式...'},null,512),[[y.vModelText,t.value.subAiRegex]]),(0,y.withDirectives)((0,y.createElementVNode)('textarea',{'onUpdate:modelValue':o[4]||(o[4]=e=>t.value.subAiRegexReplacement=e),class:'text_pole',placeholder:'输入替换内容...'},null,512),[[y.vModelText,t.value.subAiRegexReplacement]])]),o[31]||(o[31]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',k,[o[19]||(o[19]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'处理后的副AI输出')],-1)),(0,y.withDirectives)((0,y.createElementVNode)('textarea',{'onUpdate:modelValue':o[5]||(o[5]=e=>n.value=e),class:'text_pole',placeholder:'这里是经过正则处理后的副AI输出...'},null,512),[[y.vModelText,n.value]]),(0,y.createElementVNode)('div',{class:'flex-container'},[(0,y.createElementVNode)('button',{class:'menu_button wide-button',onClick:l},'发送')])]),o[32]||(o[32]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',U,[o[20]||(o[20]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'API 调用设置')],-1)),o[21]||(o[21]=(0,y.createElementVNode)('label',{for:'auto_runner_api_url'},'API 地址',-1)),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_api_url','onUpdate:modelValue':o[6]||(o[6]=e=>t.value.apiUrl=e),type:'text',class:'text_pole',placeholder:'http://localhost:1234/v1'},null,512),[[y.vModelText,t.value.apiUrl]]),o[22]||(o[22]=(0,y.createElementVNode)('label',{for:'auto_runner_api_key'},'API 密钥',-1)),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_api_key','onUpdate:modelValue':o[7]||(o[7]=e=>t.value.apiKey=e),type:'password',class:'text_pole',placeholder:'留空表示无需密钥'},null,512),[[y.vModelText,t.value.apiKey]]),(0,y.createElementVNode)('div',{class:'flex-container'},[(0,y.createElementVNode)('button',{class:'menu_button wide-button',onClick:a},'获取模型')]),o[23]||(o[23]=(0,y.createElementVNode)('label',{for:'auto_runner_model'},'模型',-1)),(0,y.withDirectives)((0,y.createElementVNode)('select',{id:'auto_runner_model','onUpdate:modelValue':o[8]||(o[8]=e=>t.value.model=e),class:'text_pole'},[t.value.model?(0,y.createCommentVNode)('v-if',!0):((0,y.openBlock)(),(0,y.createElementBlock)('option',C,'请先获取模型')),((0,y.openBlock)(!0),(0,y.createElementBlock)(y.Fragment,null,(0,y.renderList)(r.value,e=>((0,y.openBlock)(),(0,y.createElementBlock)('option',{key:e,value:e},(0,y.toDisplayString)(e),9,D))),128))],512),[[y.vModelSelect,t.value.model]]),(0,y.createElementVNode)('label',P,'Temperature: '+(0,y.toDisplayString)(t.value.temperature),1),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_temperature','onUpdate:modelValue':o[9]||(o[9]=e=>t.value.temperature=e),type:'range',step:'0.1',min:'0',max:'2'},null,512),[[y.vModelText,t.value.temperature,void 0,{number:!0}]]),(0,y.createElementVNode)('label',M,'Top P: '+(0,y.toDisplayString)(t.value.top_p),1),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_top_p','onUpdate:modelValue':o[10]||(o[10]=e=>t.value.top_p=e),type:'range',step:'0.05',min:'0',max:'1'},null,512),[[y.vModelText,t.value.top_p,void 0,{number:!0}]]),(0,y.createElementVNode)('label',O,'Top K: '+(0,y.toDisplayString)(t.value.top_k),1),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_top_k','onUpdate:modelValue':o[11]||(o[11]=e=>t.value.top_k=e),type:'range',step:'1',min:'0',max:'100'},null,512),[[y.vModelText,t.value.top_k,void 0,{number:!0}]]),(0,y.createElementVNode)('label',B,'Max Tokens: '+(0,y.toDisplayString)(t.value.max_tokens),1),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_max_tokens','onUpdate:modelValue':o[12]||(o[12]=e=>t.value.max_tokens=e),type:'number',class:'text_pole',min:'1'},null,512),[[y.vModelText,t.value.max_tokens,void 0,{number:!0}]])]),o[33]||(o[33]=(0,y.createElementVNode)('hr',null,null,-1)),(0,y.createElementVNode)('div',G,[o[24]||(o[24]=(0,y.createElementVNode)('div',null,[(0,y.createElementVNode)('strong',null,'自动化设置')],-1)),o[25]||(o[25]=(0,y.createElementVNode)('label',{for:'auto_runner_total_replies'},'总回复次数',-1)),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_total_replies','onUpdate:modelValue':o[13]||(o[13]=e=>t.value.totalReplies=e),type:'number',class:'text_pole',min:'1'},null,512),[[y.vModelText,t.value.totalReplies,void 0,{number:!0}]]),o[26]||(o[26]=(0,y.createElementVNode)('label',{for:'auto_runner_max_retries'},'最大重试次数',-1)),(0,y.withDirectives)((0,y.createElementVNode)('input',{id:'auto_runner_max_retries','onUpdate:modelValue':o[14]||(o[14]=e=>t.value.maxRetries=e),type:'number',class:'text_pole',min:'0'},null,512),[[y.vModelText,t.value.maxRetries,void 0,{number:!0}]]),o[27]||(o[27]=(0,y.createElementVNode)('label',{for:'auto_runner_executed_count'},'自动执行次数计数',-1)),(0,y.createElementVNode)('div',L,(0,y.toDisplayString)(t.value.executedCount),1)])])]))}});n(642);const F=(0,n(42).A)(j,[['__scopeId','data-v-1f19aa45']]),K=(0,y.createApp)(F);function H(){try{!function(){if($(`head > div[script_id="${getScriptId()}"]`).length>0)return;const e=$('<div>').attr('script_id',getScriptId()).append($('head > style',document).clone());$('head').append(e)}();const t=$('#extensions_settings2');if(0===t.length)return void toastr.error('找不到注入点 #extensions_settings2，无法创建界面。','[AutoRunner] 错误');const r=$('<div>').attr('script_id',getScriptId());t.append(r),K.use(e()).mount(r[0]),toastr.success('Auto脚本加载成功')}catch(e){console.error('[AutoRunner] 初始化面板时出错:',e),toastr.error(`初始化面板时出错: ${e.message}`,'[AutoRunner] 致命错误')}}function J(){K.unmount(),$(`#extensions_settings2 > div[script_id="${getScriptId()}"]`).remove(),$(`head > div[script_id="${getScriptId()}"]`).remove()}$(()=>{H()}),$(window).on('pagehide',()=>{J(),N()});